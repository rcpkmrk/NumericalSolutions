clc;clear;
h = 0.1;x0=0;y0=1;xn=2;
n = (xn-x0)/h;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%                   Euler                     %%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
x1(1)=x0;y1(1)=y0;
f = @(x1,y1) -2*y1 + x1^2;
for i=1:n
    y1(i+1) = y1(i) + h*f(x1(i),y1(i));
    x1(i+1) = x0 + i*h;
    y_euler(i)=y1(i+1);
end 
%}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%                   RK2                       %%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
x2(1)=x0;y2(1)=y0;
f = @(x2,y2) -2*y2 + x2^2;
for i=1:n
    x2(i+1) = x0 + i*h;
    k1 = h*f(x2(i),y2(i));
    k2 = h*f(x2(i+1),y2(i)+k1);
    y2(i+1) = y2(i) + (1/2)*(k1+k2);
    y_rk2(i)=y2(i+1);
end 
%}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%                   RK4                       %%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
x3(1)=x0;y3(1)=y0;
f = @(x3,y3) -2*y3 + x3^2;
for i=1:n
    x3(i+1) = x0 + i*h;
    k1 = h*f(x3(i),y3(i));
    k2 = h*f(x3(i)+(h/2),y3(i)+(k1/2));
    k3 = h*f(x3(i)+(h/2),y3(i)+(k2/2));
    k4 = h*f(x3(i)+h,y3(i)+k3);
    y3(i+1) = y3(i) + (1/6)*(k1+2*k2+2*k3+k4);
    y_rk4(i)=y3(i+1);
end    
%}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%             Analytical Solution             %%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

x_a = 0:0.1:1.9;
y_a = (x_a.^2)./2-(2*x_a-1)./4+3./(4*exp(2*x_a));
%}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%                     Error                   %%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

for i=1:n
Err_euler(i)=abs(y_euler(i)-y_a(i));
Err_RK2(i)=abs(y_rk2(i)-y_a(i));
Err_RK4(i)=abs(y_rk4(i)-y_a(i));
end
%}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%                     Plots                   %%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%      Plot for Methods     %%%%%%%%%%%%%%%%%%%%%%%%
   
plot(x1,y1,'LineWidth',2)
hold on   
plot(x2,y2,'LineWidth',2)
plot(x3,y3,'LineWidth',2)
%plot(x_a,y_a,'LineWidth',2)
xlabel('x')
ylabel('y')
title('Solution with Different Methods')
legend('Euler','RK2','RK4','Analytical')
title(legend,'Methods')
%}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%      Plot for Error       %%%%%%%%%%%%%%%%%%%%%%%%
%{
plot(Err_euler,x_a,'LineWidth',2)
hold on
plot(Err_RK2,x_a,'LineWidth',2)
plot(Err_RK4,x_a,'LineWidth',2)
xlabel('Error(numerical-analytical)')
ylabel('x')
title('Solution with Different Methods')
legend('Euler','RK2','RK4')
title(legend,'Methods')
%}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
set(gca,'FontSize',20)
set(gcf, 'PaperPosition', [-4 4 30 20])
set(groot, 'DefaultFigurePosition', [500 600 1000 700])